<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Myflix</title>
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/modal.css">
    <link rel="stylesheet" href="/css/watch-mark.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="navbar" id="navbar">
        <div class="navbar-left">
            <a href="/" class="netflix-logo">
                MYFLIX
            </a>
            <nav class="main-nav">
                <a href="/" class="nav-link">Home</a>
                <a href="javascript:void(0)" class="nav-link" onclick="filterByType('tv')">TV Shows</a>
                <a href="javascript:void(0)" class="nav-link" onclick="filterByType('movie')">Movies</a>
                <a href="javascript:void(0)" class="nav-link" onclick="showNewPopular()">New & Popular</a>
                <a href="javascript:void(0)" class="nav-link" onclick="showMyList()">My List</a>
            </nav>
        </div>
        <div class="navbar-right">
            <div class="search-container">
                <button class="search-toggle" onclick="toggleSearch()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M14 11C14 14.3137 11.3137 17 8 17C4.68629 17 2 14.3137 2 11C2 7.68629 4.68629 5 8 5C11.3137 5 14 7.68629 14 11ZM14.3623 15.8506C12.7815 17.3438 10.5044 18 8 18C4.13401 18 1 14.866 1 11C1 7.13401 4.13401 4 8 4C11.866 4 15 7.13401 15 11C15 12.0604 14.7056 13.0423 14.1945 13.8701L22.2071 21.8828L21.5 22.5899L14.3623 15.8506Z" fill="currentColor"/>
                    </svg>
                </button>
                <input type="text" id="searchInput" placeholder="Search titles, people, genres..." class="search-input" autocomplete="off" spellcheck="false">
                <div class="search-suggestions" id="searchSuggestions"></div>
            </div>
            <div class="profile-menu">
                <div class="profile-avatar">
                    <div class="avatar-icon">U</div>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <section class="hero-banner" {% if backdrop_urls and backdrop_urls|length > 0 %}style="background-image: url('{{ backdrop_urls[0] }}'); background-size: cover; background-position: center;"{% else %}style="background: linear-gradient(77deg, rgba(229,9,20,.8), rgba(0,0,0,.6)), linear-gradient(135deg, #141414 0%, #1a1a1a 50%, #141414 100%);"{% endif %}>
            <!-- Navigation arrows for hero banner -->
            <button class="hero-nav-arrow hero-nav-prev" id="heroPrevBtn">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" fill="currentColor"/>
                </svg>
            </button>
            <button class="hero-nav-arrow hero-nav-next" id="heroNextBtn">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" fill="currentColor"/>
                </svg>
            </button>
            
            <!-- Netflix-style mute/unmute button -->
            <button class="hero-sound-toggle" id="heroSoundToggle" style="display: none;">
                <svg class="sound-on" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z" fill="currentColor"/>
                </svg>
                <svg class="sound-off" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                    <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z" fill="currentColor"/>
                </svg>
            </button>

            <div class="hero-content">
                <div class="hero-info">
                    {% if trending_movies and trending_movies|length > 0 %}
                    <!-- Hidden data for hero card -->
                    <div class="hidden" data-hero="true" data-type="movie" data-id="{{ trending_movies[0].imdb_id }}" data-tmdb-id="{{ trending_movies[0].tmdb_id }}"></div>
                    
                    <!-- Netflix-style logo/title image (if available) -->
                    <div class="hero-logo">
                        <h1 class="hero-title">{{ trending_movies[0].title }}</h1>
                    </div>
                    {% else %}
                    <div class="hero-logo">
                        <h1 class="hero-title">Welcome to Myflix</h1>
                    </div>
                    <p class="hero-overview">Unlimited movies, TV shows, and more.</p>
                    {% endif %}
                    
                    <div class="hero-buttons">
                        <button class="btn btn-primary" id="heroPlayBtn">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 5v14l11-7z" fill="currentColor"/>
                            </svg>
                            Play
                        </button>
                        <button class="btn btn-secondary" id="moreInfoBtn">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z" fill="currentColor"/>
                            </svg>
                            <span id="moreInfoText">More Info</span>
                        </button>
                        
                        <!-- Netflix-style additional buttons -->
                        <button class="btn btn-icon" id="heroAddBtn" title="Add to My List">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="currentColor" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </button>
                        <button class="btn btn-icon" id="heroLikeBtn" title="Rate">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z" fill="currentColor" stroke="currentColor" stroke-width="1"/>
                            </svg>
                        </button>
                    </div>
                    
                    {% if trending_movies and trending_movies|length > 0 %}
                    <!-- Expanded info section (hidden by default) -->
                    <div class="hero-expanded-info" id="heroExpandedInfo">
                        <div class="hero-synopsis-full" id="heroSynopsis">
                            <p>{{ trending_movies[0].overview if trending_movies[0].overview else "Full description of the movie goes here with all the details about plot, characters, and what makes it worth watching." }}</p>
                            <button class="hero-show-more-btn" id="heroShowMoreBtn" onclick="toggleHeroExpanded()">
                                <span id="heroShowMoreText">Show More</span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7 10l5 5 5-5z" fill="currentColor"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    {% endif %}
                </div>
                
                <!-- Netflix-style fade gradients -->
                <div class="hero-fade-bottom"></div>
                <div class="hero-vignette"></div>
            </div>
        </section>

        <!-- Continue Watching Row -->
        {% if continue_watching and continue_watching|length > 0 %}
        <section class="content-row">
            <div class="row-header">
                <h2 class="row-title">Continue Watching</h2>
            </div>
            <div class="row-slider">
                <div class="slider-container" id="continue-watching-slider">
                    {% for item in continue_watching %}
                    <div class="title-card" data-title="{{ item.title }}" data-type="{{ item.type }}" data-id="{{ item.id }}" data-tmdb-id="{{ item.tmdb_id }}">
                        <div class="title-card-image">
                            <span class="continue-watching-badge">Continue Watching</span>
                            {% if item.poster_url %}
                            <img src="{{ item.poster_url }}" alt="{{ item.title }}" loading="lazy">
                            {% else %}
                            <div class="placeholder-image">
                                <span>{{ item.title[:1] }}</span>
                            </div>
                            {% endif %}
                            <div class="progress-bar-container">
                                <div class="progress-bar" style="width: {{ (item.progress / item.duration * 100)|round|int }}%"></div>
                            </div>
                        </div>
                        <div class="title-card-metadata">
                            <div class="metadata-top">
                                <div class="title-card-play-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M8 5v14l11-7z" fill="currentColor"/>
                                    </svg>
                                </div>
                                <div class="title-card-add-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="currentColor"/>
                                    </svg>
                                </div>
                                <div class="title-card-like-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z" fill="currentColor"/>
                                    </svg>
                                </div>
                                <div class="title-card-expand-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z" fill="currentColor"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="metadata-bottom">
                                <div class="title-card-title">{{ item.title }}</div>
                                <div class="title-card-genres">
                                    <span class="genre-tag">{{ (item.progress / item.duration * 100)|round|int }}% watched</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </section>
        {% endif %}

        <!-- Trending Movies Row -->
        <section class="content-row">
            <div class="row-header">
                <h2 class="row-title">Trending Now</h2>
            </div>
            <div class="row-slider">
                <div class="slider-container" id="trending-movies-slider">
                    {% for movie in trending_movies %}
                    <div class="title-card" data-title="{{ movie.title }}" data-type="movie" data-id="{{ movie.imdb_id }}" data-tmdb-id="{{ movie.tmdb_id }}">
                        <div class="title-card-image">
                            {% if movie.poster_url %}
                            <img src="{{ movie.poster_url }}" alt="{{ movie.title }}" loading="lazy">
                            {% else %}
                            <div class="placeholder-image">
                                <span>{{ movie.title[:1] }}</span>
                            </div>
                            {% endif %}
                        </div>
                        <div class="title-card-metadata">
                            <div class="metadata-top">
                                <div class="title-card-play-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M8 5v14l11-7z" fill="currentColor"/>
                                    </svg>
                                </div>
                                <div class="title-card-add-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="currentColor"/>
                                    </svg>
                                </div>
                                <div class="title-card-like-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z" fill="currentColor"/>
                                    </svg>
                                </div>
                                <div class="title-card-expand-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z" fill="currentColor"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="metadata-bottom">
                                <div class="title-card-title">{{ movie.title }}</div>
                                <div class="title-card-genres">
                                    <span class="genre-tag">{{ movie.quality }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </section>

		
        <!-- Trending TV Shows Row -->
        <section class="content-row">
			<div class="row-header">
                <h2 class="row-title">Trending TV Shows</h2>
            </div>
            <div class="row-slider">
				<div class="slider-container" id="trending-series-slider">
                    {% for show in trending_series %}
                    <div class="title-card" data-title="{{ show.title }}" data-type="series" data-id="{{ show.imdb_id }}" data-tmdb-id="{{ show.tmdb_id }}">
						<div class="title-card-image">
                            {% if show.poster_url %}
                            <img src="{{ show.poster_url }}" alt="{{ show.title }}" loading="lazy">
                            {% else %}
                            <div class="placeholder-image">
								<span>{{ show.title[:1] }}</span>
                            </div>
                            {% endif %}
                        </div>
                        <div class="title-card-metadata">
							<div class="metadata-top">
								<div class="title-card-play-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M8 5v14l11-7z" fill="currentColor"/>
                                    </svg>
                                </div>
                                <div class="title-card-add-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="currentColor"/>
                                    </svg>
                                </div>
                                <div class="title-card-like-button">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z" fill="currentColor"/>
                                    </svg>
                                </div>
                                <div class="title-card-expand-button">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z" fill="currentColor"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="metadata-bottom">
								<div class="title-card-title">{{ show.title }}</div>
                                <div class="title-card-genres">
                                    <span class="genre-tag">HD</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </section>

		<!-- Movies Row -->
		<section class="content-row">
			<div class="row-header">
				<h2 class="row-title">{% if search_query %}Search Results for "{{ search_query }}"{% else %}Latest Movies{% endif %}</h2>
			</div>
			<div class="row-slider">
				<div class="slider-container" id="movies-slider">
					{% for movie in movies %}
					<div class="title-card" data-title="{{ movie.title }}" data-type="movie" data-id="{{ movie.imdb_id }}" data-tmdb-id="{{ movie.tmdb_id }}">
						<div class="title-card-image">
							{% if movie.poster_url %}
							<img src="{{ movie.poster_url }}" alt="{{ movie.title }}" loading="lazy">
							{% else %}
							<div class="placeholder-image">
								<span>{{ movie.title[:1] }}</span>
							</div>
							{% endif %}
						</div>
						<div class="title-card-metadata">
							<div class="metadata-top">
								<div class="title-card-play-button">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path d="M8 5v14l11-7z" fill="currentColor"/>
									</svg>
								</div>
								<div class="title-card-add-button">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="currentColor"/>
									</svg>
								</div>
								<div class="title-card-like-button">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z" fill="currentColor"/>
									</svg>
								</div>
								<div class="title-card-expand-button">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z" fill="currentColor"/>
									</svg>
								</div>
							</div>
							<div class="metadata-bottom">
								<div class="title-card-title">{{ movie.title }}</div>
								<div class="title-card-genres">
									<span class="genre-tag">{{ movie.quality }}</span>
								</div>
							</div>
						</div>
					</div>
					{% endfor %}
				</div>
				<button class="load-more-button" onclick="loadMoreMovies()">
					{% if search_query %}Load More{% else %}Load More Movies{% endif %}
				</button>
			</div>
		</section>
		
        <!-- TV Shows Row -->
        <section class="content-row">
            <div class="row-header">
				<h2 class="row-title">{% if search_query %}More Search Results{% else %}Popular TV Shows{% endif %}</h2>
            </div>
            <div class="row-slider">
                <div class="slider-container" id="series-slider">
                    {% for show in series %}
                    <div class="title-card" data-title="{{ show.title }}" data-type="series" data-id="{{ show.imdb_id }}" data-tmdb-id="{{ show.tmdb_id }}">
                        <div class="title-card-image">
                            {% if show.poster_url %}
                            <img src="{{ show.poster_url }}" alt="{{ show.title }}" loading="lazy">
                            {% else %}
                            <div class="placeholder-image">
                                <span>{{ show.title[:1] }}</span>
                            </div>
                            {% endif %}
                        </div>
                        <div class="title-card-metadata">
                            <div class="metadata-top">
                                <div class="title-card-play-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M8 5v14l11-7z" fill="currentColor"/>
                                    </svg>
                                </div>
                                <div class="title-card-add-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="currentColor"/>
                                    </svg>
                                </div>
                                <div class="title-card-like-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z" fill="currentColor"/>
                                    </svg>
                                </div>
                                <div class="title-card-expand-button">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z" fill="currentColor"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="metadata-bottom">
                                <div class="title-card-title">{{ show.title }}</div>
                                <div class="title-card-genres">
                                    <span class="genre-tag">Series</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <button class="load-more-button" onclick="loadMoreSeries()">
                    {% if search_query %}Load More{% else %}Load More Shows{% endif %}
                </button>
            </div>
        </section>
    </main>

    <!-- Myflix JavaScript Modules -->
    <!-- Load netflix.js first as it defines homeflixApp used by other modules -->
    <script src="/static/js/netflix.js"></script>
    <script src="/static/js/hero-banner.js"></script>
    <script src="/static/js/ui-components.js"></script>
    <script src="/static/js/title-cards.js"></script>
    <script src="/static/js/content-loader.js"></script>
    <script src="/static/js/my-list.js"></script>
    <script src="/static/js/watch-mark.js"></script>
    <script src="/static/js/navigation.js"></script>
    <script src="/static/js/init.js"></script>
    
    <!-- Initialize page data AFTER all JS modules are loaded -->
    <script>
        
        // Initialize data from Flask template
        if (typeof initializePaginationData === 'function') {
            initializePaginationData({{ movie_page }}, {{ series_page }}, "{{ search_query|default('') }}");
        }
        if (typeof initializeHeroBannerData === 'function') {
            initializeHeroBannerData({{ backdrop_urls | tojson }}, {{ trending_movies | tojson }});
        }
        
        
        if (typeof initializeSearch === 'function') {
            initializeSearch();
        }
    </script>
</body>
</html>